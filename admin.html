<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>

<style>
body{font-family:Arial;background:#f4f6f9;margin:0}
header{background:black;color:white;padding:15px;text-align:center;font-size:20px}
.container{max-width:900px;margin:20px auto;padding:15px}
input{padding:10px;margin:6px 0;border-radius:6px;border:1px solid #ccc;width:100%}
button{padding:6px 12px;border:none;border-radius:6px;cursor:pointer;margin:3px;font-size:13px}
.btn-black{background:black;color:white}
.btn-red{background:#e74c3c;color:white}
.btn-green{background:#27ae60;color:white}
.btn-blue{background:#3498db;color:white}
.companyCard{background:white;padding:15px;margin:15px 0;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,0.08)}
.modelRow{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px solid #eee}
.popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
background:white;padding:20px;border-radius:10px;box-shadow:0 5px 20px rgba(0,0,0,0.2);
display:none;width:300px;z-index:1000}
.overlay{position:fixed;width:100%;height:100%;background:rgba(0,0,0,0.4);
display:none;z-index:999}
h3{margin:5px 0}
</style>
</head>
<body>

<header>ðŸ”¥ Admin Panel</header>

<div class="container">

<div id="loginDiv">
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">
<button class="btn-black" onclick="login()">Login</button>
</div>

<div id="adminDiv" style="display:none;">
<input type="text" id="searchBox" placeholder="Search..." oninput="searchFilter()">

<input type="text" id="newCompany" placeholder="New Company Name">
<button class="btn-green" onclick="addCompany()">Add Company</button>

<div id="companyList"></div>

<button class="btn-red" onclick="logout()">Logout</button>
</div>

</div>

<div class="overlay" id="overlay"></div>

<div class="popup" id="popup">
<h3 id="popupTitle">Edit</h3>
<input type="text" id="modelName">
<input type="number" id="modelPrice">
<button class="btn-blue" onclick="savePopup()">Save</button>
<button class="btn-red" onclick="closePopup()">Cancel</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, collection, doc, setDoc, deleteDoc, onSnapshot, deleteField } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBUals9JsemB1NZk9byCaQyx-IESPTCnuU",
  authDomain: "baba-folder.firebaseapp.com",
  projectId: "baba-folder",
  storageBucket: "baba-folder.appspot.com",
  messagingSenderId: "641161753750",
  appId: "1:641161753750:web:d80be1d6affbae5ffffeb7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentCompany="";
let currentModel="";
let mode="";

window.login=()=>signInWithEmailAndPassword(auth,email.value,password.value)
.catch(err=>alert(err.message));

window.logout=()=>signOut(auth);

onAuthStateChanged(auth,user=>{
if(user){
loginDiv.style.display="none";
adminDiv.style.display="block";
loadCompanies();
}else{
loginDiv.style.display="block";
adminDiv.style.display="none";
}
});

function loadCompanies(){
onSnapshot(collection(db,"companies"),snapshot=>{
companyList.innerHTML="";
snapshot.forEach(docSnap=>{
const data=docSnap.data();
const companyName=docSnap.id;

const card=document.createElement("div");
card.className="companyCard";

card.innerHTML=`
<h3>${companyName}</h3>
<button class="btn-green" onclick="openAddModel('${companyName}')">Add Model</button>
<button class="btn-red" onclick="deleteCompany('${companyName}')">Delete Company</button>
`;

Object.keys(data).forEach(model=>{
const row=document.createElement("div");
row.className="modelRow";

row.innerHTML=`
<span>${model} - â‚¹${data[model]}</span>
<div>
<button class="btn-blue" onclick="openEdit('${companyName}','${model}',${data[model]})">Edit</button>
<button class="btn-red" onclick="deleteModel('${companyName}','${model}')">Delete</button>
</div>
`;
card.appendChild(row);
});

companyList.appendChild(card);
});
});
}

window.addCompany=async()=>{
if(!newCompany.value) return;
await setDoc(doc(db,"companies",newCompany.value),{});
newCompany.value="";
}

window.deleteCompany=(name)=>deleteDoc(doc(db,"companies",name));

window.openAddModel=(company)=>{
mode="add";
currentCompany=company;
popupTitle.innerText="Add Model";
modelName.value="";
modelPrice.value="";
popup.style.display="block";
overlay.style.display="block";
}

window.openEdit=(company,model,price)=>{
mode="edit";
currentCompany=company;
currentModel=model;
popupTitle.innerText="Edit Model";
modelName.value=model;
modelPrice.value=price;
popup.style.display="block";
overlay.style.display="block";
}

window.savePopup=async()=>{
if(!modelName.value||!modelPrice.value) return;

if(mode==="edit"){
await setDoc(doc(db,"companies",currentCompany),{
[currentModel]:deleteField()
},{merge:true});
}

await setDoc(doc(db,"companies",currentCompany),{
[modelName.value]:Number(modelPrice.value)
},{merge:true});

closePopup();
}

window.deleteModel=(company,model)=>{
setDoc(doc(db,"companies",company),{
[model]:deleteField()
},{merge:true});
}

window.closePopup=()=>{
popup.style.display="none";
overlay.style.display="none";
}

window.searchFilter=()=>{
const search=searchBox.value.toLowerCase();
document.querySelectorAll(".companyCard").forEach(card=>{
card.style.display=card.innerText.toLowerCase().includes(search)?"block":"none";
});
}
</script>

</body>
</html>const db = getFirestore(app);

let currentCompany="";
let currentModel="";

window.login=()=>{
signInWithEmailAndPassword(auth,email.value,password.value)
.catch(err=>alert(err.message));
}

onAuthStateChanged(auth,user=>{
if(user){
loginDiv.style.display="none";
adminDiv.style.display="block";
loadCompanies();
}else{
loginDiv.style.display="block";
adminDiv.style.display="none";
}
});

window.logout=()=>signOut(auth);

function loadCompanies(){
onSnapshot(collection(db,"companies"),snapshot=>{
companyList.innerHTML="";
snapshot.forEach(docSnap=>{
const data=docSnap.data();
const companyName=docSnap.id;

const card=document.createElement("div");
card.className="companyCard";
card.setAttribute("data-name",companyName.toLowerCase());

card.innerHTML=`<h3>${companyName}</h3>`;

Object.keys(data).forEach(model=>{
const row=document.createElement("div");
row.className="modelRow";
row.setAttribute("data-model",model.toLowerCase());

row.innerHTML=`
<span>${model} - â‚¹${data[model]}</span>
<div>
<button class="btn-blue" onclick="editModel('${companyName}','${model}',${data[model]})">Edit</button>
<button class="btn-red" onclick="deleteModel('${companyName}','${model}')">ðŸ—‘</button>
</div>`;
card.appendChild(row);
});

card.innerHTML+=`<button class="btn-red" onclick="deleteCompany('${companyName}')">Delete Company</button>`;

companyList.appendChild(card);
});
});
}

window.addCompany=async()=>{
if(!newCompany.value) return;
await setDoc(doc(db,"companies",newCompany.value),{});
newCompany.value="";
}

window.deleteCompany=async(name)=>{
await deleteDoc(doc(db,"companies",name));
}

window.deleteModel=async(company,model)=>{
await setDoc(doc(db,"companies",company),{[model]:deleteField()},{merge:true});
}

window.editModel=(company,model,price)=>{
currentCompany=company;
currentModel=model;
editName.value=model;
editPrice.value=price;
popup.style.display="block";
overlay.style.display="block";
}

window.saveEdit=async()=>{
await setDoc(doc(db,"companies",currentCompany),{
[currentModel]:deleteField()
},{merge:true});

await setDoc(doc(db,"companies",currentCompany),{
[editName.value]:Number(editPrice.value)
},{merge:true});

closePopup();
}

window.closePopup=()=>{
popup.style.display="none";
overlay.style.display="none";
}

searchBox.addEventListener("input",()=>{
const value=searchBox.value.toLowerCase();

document.querySelectorAll(".companyCard").forEach(card=>{
const companyMatch=card.dataset.name.includes(value);
let modelMatch=false;

card.querySelectorAll(".modelRow").forEach(row=>{
if(row.dataset.model.includes(value)){
modelMatch=true;
}
});

card.style.display=(companyMatch||modelMatch)?"block":"none";
});
});

</script>
</body>
</html>document.getElementById("models").value="";

}catch(error){
alert("Error: "+error.message);
}

}

</script>

</body>
</html>
