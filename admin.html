<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>

<style>
body{
font-family:Arial;
text-align:center;
margin-top:40px;
background:#f2f2f2;
}

input,textarea,button{
padding:10px;
margin:8px;
width:280px;
border-radius:6px;
border:1px solid #ccc;
}

textarea{
width:90%;
height:150px;
}

button{
background:black;
color:white;
cursor:pointer;
border:none;
}

h2{
margin-bottom:20px;
}
</style>
</head>
<body>

<h2>Admin Login</h2>

<div id="loginDiv">
<input type="email" id="email" placeholder="Email"><br>
<input type="password" id="password" placeholder="Password"><br>
<button onclick="login()">Login</button>
</div>

<div id="adminDiv" style="display:none;">
<h3>Add / Update Company Data</h3>

<input type="text" id="company" placeholder="Company Name"><br>

<textarea id="models" placeholder="Format:
Model1,1200
Model2,1500"></textarea><br>

<button onclick="saveData()">Save</button>
<button onclick="logout()">Logout</button>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBUals9JsemB1NZk9byCaQyx-IESPTCnuU",
  authDomain: "baba-folder.firebaseapp.com",
  projectId: "baba-folder",
  storageBucket: "baba-folder.firebasestorage.app",
  messagingSenderId: "641161753750",
  appId: "1:641161753750:web:d80be1d6affbae5ffffeb7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.login = function(){

const email=document.getElementById("email").value.trim();
const password=document.getElementById("password").value.trim();

if(!email || !password){
alert("Enter Email & Password");
return;
}

signInWithEmailAndPassword(auth,email,password)
.then(()=>{
document.getElementById("loginDiv").style.display="none";
document.getElementById("adminDiv").style.display="block";
})
.catch((error)=>{
alert("Login Failed: " + error.message);
});
}

window.logout = function(){
signOut(auth);
location.reload();
}

window.saveData = async function(){

const company=document.getElementById("company").value.trim();
const modelsRaw=document.getElementById("models").value.trim().split("\n");

if(!company){
alert("Enter Company Name");
return;
}

let models=[];

modelsRaw.forEach(line=>{
if(line.includes(",")){
let parts=line.split(",");
models.push({
name:parts[0].trim(),
price:parts[1].trim()
});
}
});

if(models.length===0){
alert("Enter at least one model");
return;
}

try{

await setDoc(doc(db,"prices",company),{
company:company,
models:models,
updatedAt:new Date()
});

alert("Saved Successfully");
document.getElementById("models").value="";

}catch(error){
alert("Error: "+error.message);
}

}

</script>

</body>
</html>
