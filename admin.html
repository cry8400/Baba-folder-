<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>
<style>
body{font-family:Arial;text-align:center;margin-top:40px}
input,button{padding:8px;margin:5px}
textarea{width:90%;height:150px}
</style>
</head>
<body>

<h2>Admin Login</h2>

<div id="loginDiv">
<input type="email" id="email" placeholder="Email"><br>
<input type="password" id="password" placeholder="Password"><br>
<button onclick="login()">Login</button>
</div>

<div id="adminDiv" style="display:none;">
<h3>Add / Update Company Data</h3>
<input type="text" id="company" placeholder="Company Name"><br>
<textarea id="models" placeholder='Format:
Model1,1200
Model2,1500'></textarea><br>
<button onclick="saveData()">Save</button>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBUals9JsemB1NZk9byCaQyx-IESPTCnuU",
  authDomain: "baba-folder.firebaseapp.com",
  projectId: "baba-folder",
  storageBucket: "baba-folder.firebasestorage.app",
  messagingSenderId: "641161753750",
  appId: "1:641161753750:web:749918781fb5f688fffeb7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.login = function(){
const email=document.getElementById("email").value;
const password=document.getElementById("password").value;

signInWithEmailAndPassword(auth,email,password)
.then(()=>{
document.getElementById("loginDiv").style.display="none";
document.getElementById("adminDiv").style.display="block";
})
.catch(()=>alert("Login Failed"));
}

window.saveData = async function(){
const company=document.getElementById("company").value;
const modelsRaw=document.getElementById("models").value.split("\n");

let models=modelsRaw.map(line=>{
let parts=line.split(",");
return {name:parts[0],price:parts[1]};
});

await setDoc(doc(db,"prices",company),{
company:company,
models:models
});

alert("Saved Successfully");
}

</script>
</body>
</html>
